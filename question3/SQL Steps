What is the relationship between Country and Revenue? 



First I identify the the tables that might contained the data  that was relevant for revenue and countries.
The tables that I found to be relevant was “SalesOrderHeader”, “SalesOrderDetail” and “SalesTerritory”.
First I extracted the TerritoryID and the LineTotal from SalesOrderHeader and SalesOrderDetail by joining the table tables on SalesOrderID using the query

	SELECT  TerritoryID, LineTotal
FROM Sales.SalesOrderHeader
JOIN Sales.SalesOrderDetail
ON Sales.SalesOrderHeader.SalesOrderID = Sales.SalesOrderDetail.SalesOrderID

Next step I summerized the LineTotal by Territory ID
Using this query
	
	SELECT TerritoryID, SUM(LineTotal) AS Revenue
FROM Sales.SalesOrderHeader
JOIN Sales.SalesOrderDetail 
ON Sales.SalesOrderHeader.SalesOrderID = Sales.SalesOrderDetail.SalesOrderID
GROUP BY TerritoryID

The next thing step is to withdraw the SaleLastYear, SalesYTD, and CountryRegionCode from SalesTerritory


That was done by joining the result from the previous query to the SalesTerritory on TerrtoryID 

	SELECT CountryRegionCode, SalesYTD, SalesLastYear, Revenue
FROM Sales.SalesTerritory
JOIN 
	  (SELECT TerritoryID, SUM(LineTotal) AS Revenue
   FROM Sales.SalesOrderHeader
	  JOIN Sales.SalesOrderDetail 
  ON Sales.SalesOrderHeader.SalesOrderID = Sales.SalesOrderDetail.SalesOrderID
	  GROUP BY TerritoryID) AS TerritoryRevenue
ON Sales.SalesTerritory.TerritoryID = TerritoryRevenue.TerritoryID


At last I grouped the totals by CoutryRegionCode

SELECT CountryRegionCode, SUM(SalesYTD) AS SalesYTD, SUM(SalesLastYear) AS SalesLastYear, SUM(Revenue) AS Revenue
FROM Sales.SalesTerritory
JOIN 
	(SELECT TerritoryID, SUM(LineTotal) AS Revenue
	FROM Sales.SalesOrderHeader
	JOIN Sales.SalesOrderDetail 
	ON Sales.SalesOrderHeader.SalesOrderID = Sales.SalesOrderDetail.SalesOrderID
	GROUP BY TerritoryID) AS TerritoryRevenue
ON Sales.SalesTerritory.TerritoryID = TerritoryRevenue.TerritoryID
GROUP BY CountryRegionCode
ORDER BY Revenue DESC






